---
swagger: "2.0"
info:
  title: NS WhatsApp Service
  description: WhatsApp Service API
  version: 1.0.3
tags:
  - name: WhatsApp Service - Send
    description: API for performing crud operations on connector system

paths:
  /v1/send:
    post:
      tags:
        - WhatsApp Service - Send
      summary: Send a WhatsApp message
      operationId: createWhatsAppMessageRequest
      parameters:
        - $ref: '#/components/parameters/transactionId'
        - $ref: '#/components/parameters/Authorization'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WhatsAppServiceSendRequest'
            examples:
              default:
                $ref: "#/components/examples/WhatsAppServiceSendRequest"
      responses:
        '201':
          $ref: '#/components/responses/successful_201'
        '400':
          $ref: '#/components/responses/invalidRequest'
        '401':
          $ref: '#/components/responses/unauthorized'
        '500':
          $ref: '#/components/responses/internalServerError'
          
components:
  schemas:
    WhatsAppServiceSendRequest:
      type: object
      properties:
        senderId:
          type: string
          description: "WhatsApp senderID - from number"
          example: "+1890890890"
        address:
          type: string
          description: "WhatsApp to number - end user whatsapp number"
          example: "+1840359390"
        message:
          type: string
          description: "Whatsapp message content"
          example: "Hello, this is a test message"
        telephoneCountryCode:
          type: string
          description: "Country code"
          example: "1"
        fiID:
          type: string
          description: "FIID"
          example: "00516"
        aggregator:
          type: string
          description: "Third party vendor. ex: syniverse"
          example: "syniverse"
        sourceSystem:
          type: string
          description: "Source application whether MFA or MBL"
          example: "MFA"
      required:
        - senderId
        - address
        - message
        - telephoneCountryCode
        - fiId
        - aggregator
        - sourceSystem
    WhatsAppServiceSendResponse:
      type: object
      properties:
        id:
          type: string
          description: "Response received from syniverse"
          example: "bx634Akt6aEDUOTsClQQc6WK27"

    ErrorResponse:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: "A unique error code for identifying the issue."
          example: "100400"
        message:
          type: string
          description: "A detailed error message explaining the issue."
          example: "Missing mandatory field '{fieldName}'."

  parameters:
    transactionId:
      name: transactionId
      in: header
      required: true
      description: Unique Identifier for the transaction.
      schema:
        type: string
      example: "12345-abcde-67890"
    Authorization:
      name: Authorization
      in: header
      required: true
      description: Authorization token, Global JWT
      schema:
        type: string
      example: "Bearer XXX"

  responses:
    successful_200: #200
      description: The request was successful. Return updated Preference
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/WhatsAppServiceSendResponse'
          examples:
            default:
              $ref: "#/components/examples/WhatsAppServiceSendResponse"

    successful_201: #201
      description: The request was successful.Alert preference created
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/WhatsAppServiceSendResponse'
          examples:
            default:
              $ref: "#/components/examples/WhatsAppServiceSendResponse"


    invalidRequest: #400
      description: Bad Request - Missing Required Fields or Invalid value
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            missingOrInvalidField:
              value:
                code: "100400"
                message: "'{fieldName}' is required, must not be blank."


    unauthorized: #401
      description: Authentication is required. Valid autorization token should pass
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            missingOrInvalidToken:
              value:
                code: "100401"
                message: "Authentication failed or token is missing."

    internalServerError: #500
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            unexpectedError:
              value:
                code: "100500"
                message: "An unexpected error occurred. Please try again later."
  examples:
  
    WhatsAppServiceSendRequest:
      summary: default
      value:
        senderId: "+1890890890"
        address: "+1840359390"
        message: "Hello, this is a test message"
        telephoneCountryCode: "1"
        fiID: "00516"
        aggregator: "syniverse"
        sourceSystem: "MFA"

    WhatsAppServiceSendResponse:
      summary: default
      value:
        id: "bx634Akt6aEDUOTsClQQc6WK27"
